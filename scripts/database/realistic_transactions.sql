-- 현실적인 거래 내역 생성 (최근 3개월)
-- 각 사용자별 특성에 맞는 거래 패턴

BEGIN;

-- 먼저 기존 거래 삭제 (demo 사용자 제외)
DELETE FROM transactions WHERE user_id != '00000000-0000-0000-0000-000000000001';

-- 김민수 (직장인) - 규칙적인 급여와 일상 지출
INSERT INTO transactions (id, user_id, account_id, category_id, amount, description, transaction_date, type, status, created_at, updated_at) VALUES

-- 9월 거래내역
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111111', 'c0000000-0000-0000-0000-000000000001', 2800000.00, '9월 급여', '2025-09-01', 'income', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111113', 'c1111111-1111-1111-1111-111111111116', 800000.00, '월세', '2025-09-03', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111111', 'c1111111-1111-1111-1111-111111111111', 45000.00, '점심 - 회사 근처 식당', '2025-09-05', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111113', 'c1111111-1111-1111-1111-111111111113', 6500.00, '스타벅스 아메리카노', '2025-09-05', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111111', 'c1111111-1111-1111-1111-111111111112', 8000.00, '지하철 교통비', '2025-09-06', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111113', 'c1111111-1111-1111-1111-111111111111', 85000.00, '저녁식사 - 동료와 회식', '2025-09-07', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111113', 'c1111111-1111-1111-1111-111111111114', 180000.00, '유니클로 셔츠 구매', '2025-09-08', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111111', 'c1111111-1111-1111-1111-111111111117', 65000.00, 'SKT 통신비', '2025-09-10', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111113', 'c1111111-1111-1111-1111-111111111115', 25000.00, '영화관 티켓 2매', '2025-09-14', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111111', 'c1111111-1111-1111-1111-111111111111', 32000.00, '주말 브런치', '2025-09-15', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111112', 'c0000000-0000-0000-0000-000000000002', 150000.00, '프리랜서 작업비', '2025-09-18', 'income', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111111', 'c1111111-1111-1111-1111-111111111112', 15000.00, '버스비', '2025-09-20', 'expense', 'completed', NOW(), NOW()),

-- 8월 거래내역
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111111', 'c0000000-0000-0000-0000-000000000001', 2800000.00, '8월 급여', '2025-08-01', 'income', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111113', 'c1111111-1111-1111-1111-111111111116', 800000.00, '월세', '2025-08-03', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111113', 'c1111111-1111-1111-1111-111111111115', 120000.00, '친구 생일파티', '2025-08-10', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111111', 'c1111111-1111-1111-1111-111111111111', 280000.00, '한 주간 식비', '2025-08-15', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111113', 'c1111111-1111-1111-1111-111111111114', 350000.00, '여름 옷 쇼핑', '2025-08-20', 'expense', 'completed', NOW(), NOW()),

-- 7월 거래내역
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111111', 'c0000000-0000-0000-0000-000000000001', 2800000.00, '7월 급여', '2025-07-01', 'income', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111113', 'c1111111-1111-1111-1111-111111111116', 800000.00, '월세', '2025-07-03', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '11111111-1111-1111-1111-111111111111', 'a1111111-1111-1111-1111-111111111113', 'c1111111-1111-1111-1111-111111111115', 200000.00, '여름휴가 경비', '2025-07-25', 'expense', 'completed', NOW(), NOW());

-- 이영희 (주부) - 가정용품, 장보기, 육아 관련 지출
INSERT INTO transactions (id, user_id, account_id, category_id, amount, description, transaction_date, type, status, created_at, updated_at) VALUES

-- 9월 거래내역
(gen_random_uuid(), '22222222-2222-2222-2222-222222222222', 'a2222222-2222-2222-2222-222222222221', 'c2222222-2222-2222-2222-222222222222', 300000.00, '생활비', '2025-09-01', 'income', 'completed', NOW(), NOW()),
(gen_random_uuid(), '22222222-2222-2222-2222-222222222222', 'a2222222-2222-2222-2222-222222222221', 'c2222222-2222-2222-2222-222222222231', 150000.00, '이마트 장보기', '2025-09-02', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '22222222-2222-2222-2222-222222222222', 'a2222222-2222-2222-2222-222222222221', 'c2222222-2222-2222-2222-222222222232', 85000.00, '아이 기저귀/분유', '2025-09-03', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '22222222-2222-2222-2222-222222222222', 'a2222222-2222-2222-2222-222222222223', 'c2222222-2222-2222-2222-222222222231', 45000.00, '동네 마트', '2025-09-05', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '22222222-2222-2222-2222-222222222222', 'a2222222-2222-2222-2222-222222222221', 'c2222222-2222-2222-2222-222222222234', 180000.00, '아이 학습지비', '2025-09-10', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '22222222-2222-2222-2222-222222222222', 'a2222222-2222-2222-2222-222222222221', 'c2222222-2222-2222-2222-222222222233', 95000.00, '소아과 진료비', '2025-09-12', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '22222222-2222-2222-2222-222222222222', 'a2222222-2222-2222-2222-222222222221', 'c2222222-2222-2222-2222-222222222235', 65000.00, '세제/청소용품', '2025-09-15', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '22222222-2222-2222-2222-222222222222', 'a2222222-2222-2222-2222-222222222223', 'c2222222-2222-2222-2222-222222222231', 38000.00, '과일/간식', '2025-09-18', 'expense', 'completed', NOW(), NOW()),

-- 8월 거래내역
(gen_random_uuid(), '22222222-2222-2222-2222-222222222222', 'a2222222-2222-2222-2222-222222222221', 'c2222222-2222-2222-2222-222222222222', 300000.00, '생활비', '2025-08-01', 'income', 'completed', NOW(), NOW()),
(gen_random_uuid(), '22222222-2222-2222-2222-222222222222', 'a2222222-2222-2222-2222-222222222221', 'c2222222-2222-2222-2222-222222222231', 220000.00, '대형마트 장보기', '2025-08-08', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '22222222-2222-2222-2222-222222222222', 'a2222222-2222-2222-2222-222222222221', 'c2222222-2222-2222-2222-222222222232', 120000.00, '아이 여름옷', '2025-08-15', 'expense', 'completed', NOW(), NOW());

-- 박철수 (자영업) - 사업 관련 수입/지출
INSERT INTO transactions (id, user_id, account_id, category_id, amount, description, transaction_date, type, status, created_at, updated_at) VALUES

-- 9월 거래내역
(gen_random_uuid(), '33333333-3333-3333-3333-333333333333', 'a3333333-3333-3333-3333-333333333331', 'c3333333-3333-3333-3333-333333333331', 4500000.00, '9월 사업수입', '2025-09-15', 'income', 'completed', NOW(), NOW()),
(gen_random_uuid(), '33333333-3333-3333-3333-333333333333', 'a3333333-3333-3333-3333-333333333331', 'c3333333-3333-3333-3333-333333333332', 1200000.00, '임대료 수입', '2025-09-01', 'income', 'completed', NOW(), NOW()),
(gen_random_uuid(), '33333333-3333-3333-3333-333333333333', 'a3333333-3333-3333-3333-333333333331', 'c3333333-3333-3333-3333-333333333341', 850000.00, '사무용품/재료비', '2025-09-05', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '33333333-3333-3333-3333-333333333333', 'a3333333-3333-3333-3333-333333333331', 'c3333333-3333-3333-3333-333333333342', 650000.00, '부가가치세', '2025-09-10', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '33333333-3333-3333-3333-333333333333', 'a3333333-3333-3333-3333-333333333331', 'c3333333-3333-3333-3333-333333333343', 280000.00, '사업자보험료', '2025-09-12', 'expense', 'completed', NOW(), NOW()),

-- 8월 거래내역
(gen_random_uuid(), '33333333-3333-3333-3333-333333333333', 'a3333333-3333-3333-3333-333333333331', 'c3333333-3333-3333-3333-333333333331', 3800000.00, '8월 사업수입', '2025-08-15', 'income', 'completed', NOW(), NOW()),
(gen_random_uuid(), '33333333-3333-3333-3333-333333333333', 'a3333333-3333-3333-3333-333333333331', 'c3333333-3333-3333-3333-333333333332', 1200000.00, '임대료 수입', '2025-08-01', 'income', 'completed', NOW(), NOW());

-- 최지은 (대학생) - 용돈, 아르바이트, 학비
INSERT INTO transactions (id, user_id, account_id, category_id, amount, description, transaction_date, type, status, created_at, updated_at) VALUES

-- 9월 거래내역
(gen_random_uuid(), '44444444-4444-4444-4444-444444444444', 'a4444444-4444-4444-4444-444444444441', 'c4444444-4444-4444-4444-444444444441', 400000.00, '부모님 용돈', '2025-09-01', 'income', 'completed', NOW(), NOW()),
(gen_random_uuid(), '44444444-4444-4444-4444-444444444444', 'a4444444-4444-4444-4444-444444444442', 'c4444444-4444-4444-4444-444444444442', 180000.00, '카페 아르바이트', '2025-09-15', 'income', 'completed', NOW(), NOW()),
(gen_random_uuid(), '44444444-4444-4444-4444-444444444444', 'a4444444-4444-4444-4444-444444444441', 'c4444444-4444-4444-4444-444444444451', 1250000.00, '2학기 등록금', '2025-09-02', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '44444444-4444-4444-4444-444444444444', 'a4444444-4444-4444-4444-444444444441', 'c4444444-4444-4444-4444-444444444452', 85000.00, '전공서적 구매', '2025-09-05', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '44444444-4444-4444-4444-444444444444', 'a4444444-4444-4444-4444-444444444442', 'c4444444-4444-4444-4444-444444444454', 12000.00, '도서관 카페', '2025-09-08', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '44444444-4444-4444-4444-444444444444', 'a4444444-4444-4444-4444-444444444442', 'c4444444-4444-4444-4444-444444444453', 65000.00, '친구들과 저녁', '2025-09-12', 'expense', 'completed', NOW(), NOW()),
(gen_random_uuid(), '44444444-4444-4444-4444-444444444444', 'a4444444-4444-4444-4444-444444444442', 'c4444444-4444-4444-4444-444444444454', 8500.00, '스터디 카페', '2025-09-18', 'expense', 'completed', NOW(), NOW()),

-- 8월 거래내역
(gen_random_uuid(), '44444444-4444-4444-4444-444444444444', 'a4444444-4444-4444-4444-444444444441', 'c4444444-4444-4444-4444-444444444441', 400000.00, '부모님 용돈', '2025-08-01', 'income', 'completed', NOW(), NOW()),
(gen_random_uuid(), '44444444-4444-4444-4444-444444444444', 'a4444444-4444-4444-4444-444444444442', 'c4444444-4444-4444-4444-444444444442', 220000.00, '여름 방학 알바', '2025-08-20', 'income', 'completed', NOW(), NOW());

COMMIT;

-- 결과 확인
SELECT 
    u.first_name || ' ' || u.last_name as user_name,
    COUNT(t.id) as transaction_count,
    SUM(CASE WHEN t.type = 'income' THEN t.amount ELSE 0 END) as total_income,
    SUM(CASE WHEN t.type = 'expense' THEN t.amount ELSE 0 END) as total_expense
FROM users u
LEFT JOIN transactions t ON u.id = t.user_id
WHERE u.id != '00000000-0000-0000-0000-000000000001'
GROUP BY u.id, u.first_name, u.last_name
ORDER BY u.first_name;